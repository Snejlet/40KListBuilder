<html xmlns:visibility="http://www.w3.org/1999/xhtml">

<head>
    <title>All</title>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css"><!-- Latest compiled and minified CSS -->
</head>

<body>

    <h1>Testing the thing to see if it works</h1>

    <div>Spoilers: Only the Tyranids have anything in them right now. So probably use those.</div>

    <!-- this is commented out. Trying to do it with a select instead.
    <table>
        <tr>
            <th>id</th>
            <th>name</th>
        </tr>

        <% armies.forEach(function(army){%>
        <tr id = "<%= army.id%>" >
            <td><%= army.id %></td>
            <td><%= army.name %></td>
        </tr>
        <%})%>
    </table>
    -->


    <select id="army" onchange="armySelected()">
        <option>Please Select Your Army</option>
        <% armies.forEach(function(army) {%>
            <option value=<%= army.name %>><%= army.name %></option>
        <%})%>
    </select>


    <!-- the below works. Now find some way of making that useful
    <select>
        <% armies.forEach(function(army) {%>
                <% if(army.name === "Imperium") {%>
                    <option><%= army.faction %></option>
                <% } %>
        <%})%>
    </select>
    -->

    <div id="faction">
    </div>

    <div id="subFaction">
    </div>

    <div id="unitList">
    </div>

    <table id="armyList">
        <tr>
            <th>Name</th>
            <th>Role</th>
            <th>Points</th>
        </tr>
    </table>

    <script>

        function armySelected() {

            // why does army.value work here? I haven't told it what army is. Surely this is the work of an enemy stand?
             //console.log(army.value)

            //Weird. Can't have an EJS file with "TheInquisition" in the name. Just defaults to being a regular file.

            var $faction = $('#faction');

            var army = document.getElementById("army");
            console.log(army.value);

            $faction.load('/faction/'+army.value);

            /*
            if (army.value === "Imperium") {
                 $faction.load('/factionImperium');
            } else if (army.value === "Chaos") {
                 $faction.load('/factionChaos');
            } else if (army.value === "Xenos") {
                $faction.load('/factionXenos');
            }
            */
        }

        function unitSelected() {

            var unit = document.getElementById("unitList").innerHTML;

            console.log(unit);
        }

    </script>

</body>

</html>